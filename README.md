# ğŸš€ æœ€çµ‚éƒ¨ç½²æŒ‡å—ï¼šå¾é›¶é–‹å§‹çš„ VM åŸºç¤è¨­æ–½è‡ªå‹•åŒ–

æœ¬æŒ‡å—åŒ…å«äº† VM ç¯„æœ¬ (Template) çš„æœ€ä½³åŒ–ã€NFS å…±äº«æœå‹™é…ç½®ï¼Œä»¥åŠæ‰€æœ‰ VM çš„ SSH ç„¡å¯†ç¢¼è¨­å®šèˆ‡å®¢æˆ¶ç«¯åˆå§‹é…ç½®ã€‚

---

## ğŸ¯ éšæ®µä¸€ï¼šVM ç¯„æœ¬æº–å‚™èˆ‡é€šç”¨åŒ–

| éšæ®µ | ä¸»é¡Œå¼·èª¿ | åŸ·è¡ŒæŒ‡ä»¤ | ç›®çš„èˆ‡èªªæ˜ |
| :--- | :--- | :--- | :--- |
| **I. é è£æœå‹™** | **æ‰€æœ‰ VM å¿…å‚™** | `sudo apt update`<br>`sudo apt install -y openssh-server nfs-common nfs-kernel-server` | å®‰è£ SSH ä¼ºæœå™¨å’Œ NFS å…±äº«æ‰€éœ€çš„æ‰€æœ‰å·¥å…·ã€‚ |
| **II. å‰µå»ºæ›è¼‰é»** | **å®¢æˆ¶ç«¯æº–å‚™** | `sudo mkdir -p /mnt/getshare` | é å…ˆå‰µå»º NFS æ›è¼‰é»ã€‚ |
| **III. æ—¥èªŒå„ªåŒ–** | **ç¡¬ç¢Ÿç©ºé–“ä¿è­·** | **ç·¨è¼¯:** `sudo nano /etc/systemd/journald.conf` <br>**è¨­å®š:** `SystemMaxUse=500M` | é™åˆ¶ç³»çµ±æ—¥èªŒå¤§å°ï¼Œé˜²æ­¢æ ¹ç›®éŒ„ `/` è¢«ä½”æ»¿ã€‚ |
| **IV. æ¸…ç† Host Key** | **é˜²æ­¢ SSH è¡çª** | `sudo rm -f /etc/ssh/ssh_host_*` | **æœ€é—œéµï¼** ç§»é™¤ä¸»æ©Ÿå”¯ä¸€è­˜åˆ¥ç¬¦ï¼Œç¢ºä¿è¤‡è£½å‡ºçš„ VM å•Ÿå‹•æ™‚è‡ªå‹•ç”Ÿæˆæ–° Keyã€‚ |
| **V. æ¸…ç†è¨˜éŒ„** | **ç¶²è·¯/å¿«å–** | `sudo rm -f /etc/udev/rules.d/70-persistent-net.rules`<br>`sudo apt clean`<br>`history -c && rm -f ~/.bash_history` | æ¸…ç†èˆŠçš„ MAC åœ°å€ç¶å®šè¨˜éŒ„ã€ç³»çµ±å¿«å–å’Œ Bash æ­·å²è¨˜éŒ„ã€‚ |
| **VI. è£½ä½œç¯„æœ¬** | **æœ€å¾Œä¸€æ­¥** | `sudo shutdown now` | æ­£å¸¸é—œæ©Ÿï¼Œç„¶å¾Œåœ¨ ESXi ä¸­å°‡æ­¤ VM è½‰æ›ç‚ºç¯„æœ¬ã€‚ |

---

## ğŸ’¾ éšæ®µäºŒï¼šNFS å…±äº«æœå‹™é…ç½® (ä¼ºæœå™¨ç«¯: `192.168.8.40`)

| éšæ®µ | ä¸»é¡Œå¼·èª¿ | è¨­å‚™ | åŸ·è¡ŒæŒ‡ä»¤ / å…§å®¹ | ç›®çš„èˆ‡èªªæ˜ |
| :--- | :--- | :--- | :--- | :--- |
| **VII. æº–å‚™è·¯å¾‘** | **å…±äº«ç›®éŒ„** | ä¼ºæœå™¨ | `sudo mkdir -p /home/ubn/Shared`<br>`sudo chown ubn:ubn /home/ubn/Shared` | å‰µå»ºå…±äº«ç›®éŒ„ä¸¦ç¢ºä¿ `ubn` æ“æœ‰è€…æ¬Šé™ã€‚ |
| **VIII. æ”¾ç½®æª”æ¡ˆ** | **è³‡æ–™ç¢ºèª** | ä¼ºæœå™¨ | `mv /home/ubn/run.sh /home/ubn/Shared/` | å°‡è¦å…±äº«çš„æª”æ¡ˆæ”¾å…¥æ­£ç¢ºè·¯å¾‘ã€‚ |
| **IX. è¨­å®šåŒ¯å‡º** | **é…ç½®æª”æ¡ˆä½ç½®** | ä¼ºæœå™¨ | **ç·¨è¼¯ï¼š** `sudo nano /etc/exports` | ä»¥ root æ¬Šé™ç·¨è¼¯ NFS åŒ¯å‡ºé…ç½®ã€‚ |
| **X. åŒ¯å‡ºè·¯å¾‘** | **IP èˆ‡è·¯å¾‘** | ä¼ºæœå™¨ | **æ–°å¢ï¼š** `/home/ubn/Shared 192.168.8.0/24(rw,sync,no_subtree_check)` | å…è¨± $192.168.8.x$ ç¶²æ®µå­˜å–æ­£ç¢ºçš„è·¯å¾‘ã€‚ |
| **XI. å•Ÿç”¨æœå‹™** | **ç«‹å³ç”Ÿæ•ˆ** | ä¼ºæœå™¨ | `sudo exportfs -ra`<br>`sudo systemctl restart nfs-server` | é‡æ–°è¼‰å…¥é…ç½®ä¸¦é‡å•Ÿ NFS æœå‹™ã€‚ |

---

## ğŸ”‘ éšæ®µä¸‰ï¼šSSH è‡ªå‹•åŒ–èˆ‡å®¢æˆ¶ç«¯åˆå§‹é…ç½®

| éšæ®µ | ä¸»é¡Œå¼·èª¿ | è¨­å‚™ | åŸ·è¡ŒæŒ‡ä»¤ / å…§å®¹ | ç›®çš„èˆ‡èªªæ˜ |
| :--- | :--- | :--- | :--- | :--- |
| **XII. ç”Ÿæˆé‡‘é‘°** | **ç®¡ç†æ©Ÿè¨­ç½®** | ç®¡ç†æ©Ÿ | `ssh-keygen -t rsa -b 4096` | åœ¨ MobaXterm Local Terminal æˆ– ç®¡ç†æ©Ÿä¸ŠåŸ·è¡Œï¼Œç”Ÿæˆå…¬é‘°ã€‚ |
| **XIII. éƒ¨ç½²å…¬é‘°** | **ç„¡å¯†ç¢¼å‰æ** | ç®¡ç†æ©Ÿ | `ssh-copy-id ubn@<ç›®æ¨™VMçš„IPåœ°å€>` | **å¿…é ˆ** å°‡å…¬é‘°éƒ¨ç½²åˆ°æ‰€æœ‰ VMã€‚ |
| **XIV. æ¸¬è©¦æ›è¼‰** | **ç¢ºèªé€£ç·š** | å®¢æˆ¶ç«¯ | `sudo mount 192.168.8.40:/home/ubn/Shared /mnt/getshare` | ç¢ºä¿ç¶²è·¯å’Œ NFS æœå‹™æ­£å¸¸ã€‚ |
| **XV. è¨­å®š fstab** | **æ°¸ä¹…æ›è¼‰** | å®¢æˆ¶ç«¯ | **ç·¨è¼¯ï¼š** `sudo nano /etc/fstab` | ç¢ºä¿é–‹æ©Ÿæ™‚è‡ªå‹•æ›è¼‰ã€‚ |
| **XVI. æ–°å¢é…ç½®** | **é…ç½®è¡Œå…§å®¹** | å®¢æˆ¶ç«¯ | **æ–°å¢ï¼š** `192.168.8.40:/home/ubn/Shared /mnt/getshare nfs defaults,ro,hard,intr,noatime,x-systemd.automount 0 0` | å¯«å…¥æ­£ç¢ºçš„ä¼ºæœå™¨ IP å’Œè·¯å¾‘ã€‚ |
| **XVII. æœ€çµ‚é©—è­‰** | **å•Ÿå‹•æª¢æŸ¥** | å®¢æˆ¶ç«¯ | `sudo mount -a`<br>`ls -l /mnt/getshare` | ç«‹å³è¼‰å…¥æ–°çš„ `fstab` é…ç½®ä¸¦é©—è­‰æª”æ¡ˆã€‚ |
